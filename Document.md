# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠... CRUD Product API Starter Kit
## **‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Project: ProductAPI** ‡∏≠‡∏¥‡∏á‡∏´‡∏•‡∏±‡∏Å **Clean Architecture**, **SOLID Principles** ‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á **Clean Code**...:

Project ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå WebAPI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£(CRUD) ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤(Product) ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏©‡∏≤ C#, Dapper(ORM ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö .NET), ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• MSSQL LocalDB, ‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏ö‡∏ö Clean Architecture ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ Clean Code ‡πÅ‡∏•‡∏∞ SOLID Principles ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏°‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á WebAPI ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏î‡∏µ ‡πÅ‡∏•‡∏∞‡∏ô‡∏≥‡πÑ‡∏õ‡∏™‡∏π‡πà ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ Microservice ‡∏ï‡πà‡∏≠‡πÑ‡∏õ... 

---

## 1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ...

* 1.1 Clean Architecture ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?
* 1.2 SOLID Principles ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?
* 1.3 High Cohesion and Low Coupling ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?
* 1.4 record ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?
* 1.5 Dapper ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?
* 1.6 Serilog ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?

---

### üîπ 1.1 Clean Architecture ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?
Clean Architecture ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö (Separation of Concerns) ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡∏à‡∏≤‡∏Å Frameworks, UI, ‡πÅ‡∏•‡∏∞ Database ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏∑‡∏≠ **Domain Layer** ‡πÅ‡∏•‡∏∞ **Application Layer** ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö (Testable), ‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤ (Maintainable), ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á (Flexible)

‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡πÜ ‡∏Ç‡∏≠‡∏á Clean Architecture ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ:
* **Domain:** ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Entities, Value Objects, ‡πÅ‡∏•‡∏∞ Domain Logic ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö
* **Application:** ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Use Cases (Application Logic), Interfaces ‡∏Ç‡∏≠‡∏á Repositories ‡πÅ‡∏•‡∏∞ Services ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
* **Infrastructure:** ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£ Implement Interfaces ‡∏à‡∏≤‡∏Å Application Layer ‡πÄ‡∏ä‡πà‡∏ô Repositories (‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Database), Services ‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å
* **Presentation (WebAPI):** ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Controllers, DTOs (Data Transfer Objects) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•, ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API

![image](https://blog.cleancoder.com/uncle-bob/images/2012-08-13-the-clean-architecture/CleanArchitecture.jpg)
https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html

‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ **`Clean Architecture`** ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå‡πÇ‡∏î‡∏¢ Robert C. Martin (Uncle Bob) ‡∏ó‡∏µ‡πà‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏° **‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô (Separation of Concerns)** ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° **Dependency Flow** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏á‡πà‡∏≤‡∏¢ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏ú‡∏π‡∏Å‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ö Framework ‡∏´‡∏£‡∏∑‡∏≠ Technology ‡πÉ‡∏î ‡πÜ

---

## üß† ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏á‡∏Å‡∏•‡∏° (Layers) ‡πÉ‡∏ô‡∏†‡∏≤‡∏û

### 1. üü° **Entities** ‚Äì *Enterprise Business Rules*

* ‡∏Ñ‡∏∑‡∏≠ **‡πÅ‡∏Å‡πà‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö** (Core Model/Domain)
* ‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏é‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏≤‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à (Business Logic) ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£
* ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏≠‡∏¥‡∏á‡∏Å‡∏±‡∏ö Framework ‡πÉ‡∏î ‡πÜ
* ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: `Product`, `Order`, `Customer`, `Policy`, ‡∏û‡∏£‡πâ‡∏≠‡∏° method ‡πÄ‡∏ä‡πà‡∏ô `CalculateTotal()`

---

### 2. üî¥ **Use Cases** ‚Äì *Application Business Rules*

* ‡πÅ‡∏™‡∏î‡∏á **‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à**
* ‡∏Ñ‡∏∑‡∏≠ Logic ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡πÄ‡∏ä‡πà‡∏ô "Create Order", "Calculate Quote"
* ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Entities ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Layer
* ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á Business Process

---

### 3. üü¢ **Interface Adapters** ‚Äì *Controllers, Presenters, Gateways*

* ‡πÄ‡∏õ‡πá‡∏ô ‚Äú‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏•‡∏á‚Äù (Adapter) ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡∏Å‡∏±‡∏ö Use Case
* ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á:

  * Input ‚Üí ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö Use Case
  * Output ‚Üí ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà View ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÑ‡∏î‡πâ
* ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô:

  * **Controllers** (‡∏à‡∏≤‡∏Å Web/HTTP Request)
  * **Presenters** (‡∏™‡πà‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á View ‡∏´‡∏£‡∏∑‡∏≠ Response)
  * **Gateways** (‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å DB/External ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à Use Case)

---

### 4. üîµ **Frameworks & Drivers** ‚Äì *UI, DB, Devices, Web*

* ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà **‡∏ô‡∏≠‡∏Å‡∏™‡∏∏‡∏î** ‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏î‡πâ
* ‡πÄ‡∏ä‡πà‡∏ô Web Framework (ASP.NET), Database (SQL/Oracle), Messaging (Kafka), External APIs ‡∏Ø‡∏•‡∏Ø
* **‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏´‡πâ Business Logic ‡∏ú‡∏π‡∏Å‡∏Å‡∏±‡∏ö Layer ‡∏ô‡∏µ‡πâ**
* ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô ‚Äú‡∏õ‡∏•‡∏±‡πä‡∏Å‡∏≠‡∏¥‡∏ô‚Äù ‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏≠‡∏î‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ

---

## üîÅ Dependency Rule (‡∏Å‡∏é‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á Clean Architecture)

* **‚Äú‡πÇ‡∏Ñ‡πâ‡∏î‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏´‡πâ‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‚Äù**
* ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢ ‡πÜ ‡∏ß‡πà‡∏≤ **‡∏Å‡∏≤‡∏£‡∏û‡∏∂‡πà‡∏á‡∏û‡∏≤ (Dependency) ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏´‡∏•‡∏à‡∏≤‡∏Å‡∏ô‡∏≠‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ**
* **‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏µ‡πâ‡∏à‡∏≤‡∏Å‡∏ô‡∏≠‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ô (Outside ‚Üí Inside)** ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏∂‡πà‡∏á‡∏û‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÑ‡∏î‡πâ
* Layer ‡∏î‡πâ‡∏≤‡∏ô‡∏ô‡∏≠‡∏Å *‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ* ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å Layer ‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô‡πÑ‡∏î‡πâ
  ‚úÖ Interface ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô Use Case / Domain ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ Framework ‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å Implement

---

## üìä Flow of Control (‡∏Ç‡∏ß‡∏≤‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏û)

1. **Controller** ‡∏£‡∏±‡∏ö Input ‚Üí ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ Use Case
2. **Use Case Interactor** ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Entity
3. **‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå** ‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô **Use Case Output Port** ‡πÑ‡∏õ‡∏¢‡∏±‡∏á **Presenter**
4. **Presenter** ‡πÅ‡∏õ‡∏•‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ‚Üí ‡∏™‡πà‡∏á‡πÑ‡∏õ UI (View/Response)

---

## üîß ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå .NET WebAPI

| Layer                | ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå/‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå          | ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤                                     |
| -------------------- | -------------------------- | ------------------------------------------- |
| Entities             | `Domain`                   | Class ‡πÄ‡∏ä‡πà‡∏ô `Product`, `Policy`              |
| Use Cases            | `Application`              | Service/Handler ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö Business Logic  |
| Interface Adapters   | `WebAPI`, `Infrastructure` | Controllers, DTO, Repository Implementation |
| Frameworks & Drivers | ASP.NET, EF Core, Serilog  | ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏ú‡∏π‡∏Å‡∏ï‡∏¥‡∏î‡πÉ‡∏ô Use Case   |

---

## ‚úÖ ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á Clean Architecture

* **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏á‡πà‡∏≤‡∏¢** (Business Logic ‡πÑ‡∏°‡πà‡∏ú‡∏π‡∏Å‡∏Å‡∏±‡∏ö DB ‡∏´‡∏£‡∏∑‡∏≠ Framework)
* **‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏á‡πà‡∏≤‡∏¢** ‡πÄ‡∏ä‡πà‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å SQL ‡πÄ‡∏õ‡πá‡∏ô Mongo ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
* **‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô** (SRP)
* **‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏î‡∏µ**

---
 

#
### 1.2 SOLID Principles ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?

SOLID ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏¢‡πà‡∏≠ ‡∏Ç‡∏≠‡∏á‡∏≠‡∏±‡∏Å‡∏©‡∏£ 5 ‡∏ï‡∏±‡∏ß ... ‡πÅ‡∏•‡∏∞‡∏°‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏ä‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ 5 ‡∏Ç‡πâ‡∏≠ ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î OOP ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡πÇ‡∏î‡∏¢‡πÄ‡∏ô‡πâ‡∏ô‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î ‡πÅ‡∏¢‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô, ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô, ‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏á‡πà‡∏≤‡∏¢, ‡πÅ‡∏•‡∏∞ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï

![image](https://github.com/user-attachments/assets/4e4a02da-8d36-4503-8c7c-4e4665cd718a)

| ‡∏¢‡πà‡∏≠   | ‡πÄ‡∏ï‡πá‡∏°                     | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÇ‡∏î‡∏¢‡∏¢‡πà‡∏≠                      |
| ----- | ------------------------------- | ----------------------------------- |
| **S** | Single Responsibility Principle (SRP) | ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ñ‡∏•‡∏≤‡∏™‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß             |
| **O** | Open/Closed Principle (SRP)           | ‡πÅ‡∏Å‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°        |
| **L** | Liskov Substitution Principle (SRP)   | Subclass ‡πÅ‡∏ó‡∏ô Superclass ‡πÑ‡∏î‡πâ         |
| **I** | Interface Segregation Principle (SRP) | Interface ‡πÅ‡∏¢‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô     |
| **D** | Dependency Inversion Principle (SRP)  | ‡∏û‡∏∂‡πà‡∏á abstraction, interface ‡πÑ‡∏°‡πà‡∏û‡∏∂‡πà‡∏á class ‡∏à‡∏£‡∏¥‡∏á |

#
### üîπ 1.3 High Cohesion and Low Coupling ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?

* **High Cohesion (‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏ß‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô)** ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á ‡πÇ‡∏°‡∏î‡∏π‡∏• (Class/Service/Function) ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏ó‡∏µ‡πà ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÅ‡∏•‡∏∞ ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á
* **Low Coupling (‡∏Å‡∏≤‡∏£‡∏û‡∏∂‡πà‡∏á‡∏û‡∏≤‡∏Å‡∏±‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÇ‡∏°‡∏î‡∏π‡∏•)** ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á ‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏Ñ‡∏ß‡∏£ ‡∏û‡∏∂‡πà‡∏á‡∏û‡∏≤‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÅ‡∏•‡∏∞ ‡∏°‡∏µ‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å
![image](https://github.com/user-attachments/assets/f92ebcc4-db33-48f2-9dd2-81eca7a5b374)

‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏û...‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á **Low Cohesion-High Coupling** ‡∏Å‡∏±‡∏ö **High Cohesion-Low Coupling** ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô **‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå**
#
### üî¥ ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢: Low Cohesion and High Coupling : ‡πÄ‡∏Å‡∏≤‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≥-‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏™‡∏π‡∏á

**‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:**

* ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÇ‡∏°‡∏î‡∏π‡∏• (‡∏Å‡∏•‡πà‡∏≠‡∏á) ‡∏°‡∏µ **‡∏´‡∏•‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡∏™‡∏°‡∏Å‡∏±‡∏ô** ‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏µ‡∏ß‡∏á‡∏Å‡∏•‡∏°, ‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°, ‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
* ‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏ï‡πà‡∏≤‡∏á ‡πÜ **‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞‡∏°‡∏≤‡∏Å** (‡πÄ‡∏™‡πâ‡∏ô‡πÇ‡∏¢‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á)

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô:**

1. **Low Cohesion (‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏≤‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≥):**

   * ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÇ‡∏°‡∏î‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ô
   * ‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏¢‡∏≤‡∏Å ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
2. **High Coupling (‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏™‡∏π‡∏á):**

   * ‡πÇ‡∏°‡∏î‡∏π‡∏•‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏û‡∏∂‡πà‡∏á‡∏û‡∏≤‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å
   * ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏´‡∏ô‡∏∂‡πà‡∏á ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏≠‡∏∑‡πà‡∏ô‡∏û‡∏±‡∏á‡∏ï‡∏≤‡∏°

#
 
### üü¢ ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤: High Cohesion and Low Coupling : ‡πÄ‡∏Å‡∏≤‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏π‡∏á-‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏ï‡πà‡∏≥

**‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:**

* ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÇ‡∏°‡∏î‡∏π‡∏• (‡∏Å‡∏•‡πà‡∏≠‡∏á) ‡∏°‡∏µ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ó‡∏µ‡πà **‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Ñ‡∏•‡∏∂‡∏á‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞** ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏°‡∏µ‡πÅ‡∏ï‡πà‡∏ß‡∏á‡∏Å‡∏•‡∏°, ‡∏≠‡∏µ‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏°‡∏µ‡πÅ‡∏ï‡πà‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°
* ‡πÄ‡∏™‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏°‡∏µ‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô

**‡∏Ç‡πâ‡∏≠‡∏î‡∏µ:**

1. **High Cohesion (‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏≤‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏π‡∏á):**

   * ‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏°‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
   * ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏á‡πà‡∏≤‡∏¢ ‡∏î‡∏π‡πÅ‡∏•‡∏á‡πà‡∏≤‡∏¢ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
2. **Low Coupling (‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏ï‡πà‡∏≥):**

   * ‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏°‡∏î‡∏π‡∏•‡πÉ‡∏î‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏´‡∏ô‡∏∂‡πà‡∏á ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏∑‡πà‡∏ô
   * ‡∏ó‡∏≥‡πÉ‡∏´‡πâ **Unit Test, Refactor, ‡πÅ‡∏•‡∏∞ Scaling ‡∏£‡∏∞‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô**

#
### üß† ‡∏™‡∏£‡∏∏‡∏õ:

| ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó                         | ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞                           | ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö                            |
| ------------------------------ | -------------------------------- | ---------------------------------- |
| ‚ùå Low Cohesion + High Coupling | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏ô‡∏Å‡∏±‡∏ô / ‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏û‡∏∂‡πà‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å   | ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏¢‡∏≤‡∏Å, ‡πÄ‡∏õ‡∏£‡∏≤‡∏∞‡∏ö‡∏≤‡∏á                 |
| ‚úÖ High Cohesion + Low Coupling | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á / ‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô | ‡∏î‡∏π‡πÅ‡∏•‡∏á‡πà‡∏≤‡∏¢, ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏á‡πà‡∏≤‡∏¢, ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÑ‡∏î‡πâ |

#

... **‡∏†‡∏≤‡∏û‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢**‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏Ñ‡∏ß‡∏£‡∏°‡∏∏‡πà‡∏á‡πÑ‡∏õ...
#

### ‡πÑ‡∏õ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á **‡∏£‡∏∞‡∏ö‡∏ö CRUD Product API** :

#

## üî¥ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏î‡∏µ (Low Cohesion, High Coupling) ‡πÄ‡∏Å‡∏≤‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≥-‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏™‡∏π‡∏á

```csharp
// ‚ùå ProductController.cs (‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô)
[ApiController]
[Route("api/products")]
public class ProductController : ControllerBase
{
    private readonly SqlConnection _connection;

    public ProductController()
    {
        _connection = new SqlConnection("conn_string");
    }

     [HttpGet]
    public IActionResult GetProducts()
    {
        var products = new List<Product>();
        var sql = "SELECT Id, Name, Price FROM Products";
        var cmd = new SqlCommand(sql, _connection);
        var reader = cmd.ExecuteReader(); 

        while (reader.Read())
        {
            var product = new Product
            {
                Id = (int)reader["Id"],
                Name = reader["Name"].ToString(),
                Price = (decimal)reader["Price"]
            };
            products.Add(product);
        }
        reader.Close();
        return Ok(products); // ‚ùå ‡∏£‡∏ß‡∏° Logic, DB, Response ‡πÉ‡∏ô method ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
    }

    [HttpPost]
    public IActionResult CreateProduct([FromBody] Product product)
    { 
        var sql = $"INSERT INTO Products (Name, Price) VALUES ('{product.Name}', {product.Price})";
        var cmd = new SqlCommand(sql, _connection);
        cmd.ExecuteNonQuery(); 

        return Ok(new { message = "Product created successfully" });
    }
}
```

### üî¥ ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ 

* ‚ùå **Low Cohesion**: Controller ‡∏ó‡∏≥‡∏ó‡∏±‡πâ‡∏á Connection, SQL, Mapping ‚Üí ‡πÑ‡∏°‡πà‡πÅ‡∏¢‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö
* ‚ùå **High Coupling**: Controller ‡∏ú‡∏π‡∏Å‡πÅ‡∏ô‡πà‡∏ô‡∏Å‡∏±‡∏ö DB ‡πÅ‡∏•‡∏∞ SQL ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
* ‚ùå ‡∏ó‡∏≥‡πÉ‡∏´‡πâ Test, Reuse, Maintenance ‡∏¢‡∏≤‡∏Å

#

## üü¢ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏î‡∏µ (High Cohesion, Low Coupling) ‡πÄ‡∏Å‡∏≤‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏π‡∏á-‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏ï‡πà‡∏≥

### ‚úÖ 1. **High Cohesion:**

Controller ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á:
**‡∏£‡∏±‡∏ö Request ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Service ‚Üí Return Response**

* ‚ùå ‡πÑ‡∏°‡πà‡∏ó‡∏≥ logic
* ‚ùå ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô SQL
* ‚ùå ‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° DB
* ‚úÖ ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÅ‡∏Ñ‡πà‡∏Å‡∏≤‡∏£ "Routing" ‡πÅ‡∏•‡∏∞ "Response"

### ‚úÖ 2. **Low Coupling:**

‡∏ú‡∏π‡∏Å‡∏Å‡∏±‡∏ö‡πÅ‡∏Ñ‡πà `IProductService` (Interface) ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏¢‡∏±‡∏á‡πÑ‡∏á

* üîÅ Service ‡∏à‡∏£‡∏¥‡∏á, mock, ‡∏´‡∏£‡∏∑‡∏≠ test double ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ Inject ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏´‡∏°‡∏î
* üîÑ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Database, Business Logic ‡∏´‡∏£‡∏∑‡∏≠ Storage ‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ Controller
* 
```csharp
// ‚úÖ ProductController.cs ‚Äì ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÅ‡∏Ñ‡πà... ‡∏£‡∏±‡∏ö Request ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Service ‚Üí Return Response
[ApiController]
[Route("api/products")]
public class ProductController : ControllerBase
{
    private readonly IProductService _productService;

    public ProductController(IProductService productService)
    {
        _productService = productService;
    }

    [HttpGet]
    public async Task<IActionResult> GetAll()
    {
        var products = await _productService.GetAllAsync();
        return Ok(products);
    }

    [HttpPost]
    public async Task<IActionResult> Create([FromBody] ProductCreateDto dto)
    {
        var newProduct = await _productService.CreateAsync(dto);
        return CreatedAtAction(nameof(GetAll), new { id = newProduct.Id }, newProduct);
    }
}
```


```csharp
// ‚úÖ ProductService.cs ‚Äì ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Business Logic
public class ProductService : IProductService
{
    private readonly IProductRepository _repository;

    public ProductService(IProductRepository repository)
    {
        _repository = repository;
    }

    public async Task<IEnumerable<ProductDto>> GetAllAsync()
    {
        return await _repository.GetAllAsync();
    }

    public async Task<ProductDto> CreateAsync(ProductCreateDto dto)
    {
        var product = new Product { Name = dto.Name, Price = dto.Price };
        var id = await _repository.InsertAsync(product);
        product.Id = id;
        return new ProductDto(product);
    }
}
```
## ‚úÖ ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á `ProductService.cs`

‚úÖ High Cohesion	‡∏Ñ‡∏•‡∏≤‡∏™‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Business Logic
‚úÖ Low Coupling	‡πÉ‡∏ä‡πâ IProductRepository ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ä‡πâ Dapper, EF, ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£ ‚Äì ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢
‚úÖ Single Responsibility	‡πÑ‡∏°‡πà‡∏™‡∏ô‡πÉ‡∏à‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£ mapping HTTP
‚úÖ Testable	Inject IProductRepository ‡πÑ‡∏î‡πâ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Unit Test ‡∏á‡πà‡∏≤‡∏¢
‚úÖ Reusable	Logic ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏à‡∏≤‡∏Å API ‡∏´‡∏£‡∏∑‡∏≠ Background Job ‡πÑ‡∏î‡πâ


```csharp
// ‚úÖ ProductRepository.cs ‚Äì ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ DB ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
public class ProductRepository : IProductRepository
{
    private readonly IDbConnection _db;

    public ProductRepository(IConfiguration config)
    {
        _db = new SqlConnection(config.GetConnectionString("DefaultConnection"));
    }

    public async Task<IEnumerable<Product>> GetAllAsync()
    {
        var sql = "SELECT * FROM Products";
        return await _db.QueryAsync<Product>(sql);
    }

    public async Task<int> InsertAsync(Product product)
    {
        var sql = "INSERT INTO Products (Name, Price) VALUES (@Name, @Price); SELECT CAST(SCOPE_IDENTITY() as int)";
        return await _db.ExecuteScalarAsync<int>(sql, product);
    }
}
```

#

## ‚úÖ ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ô‡∏µ‡πâ

| ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£                | ‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ                                                                 |
| ---------------------- | -------------------------------------------------------------------------- |
| **High Cohesion**      | Controller ‚Üí Routing / Service ‚Üí Business Logic / Repo ‚Üí DB Access         |
| **Low Coupling**       | Layer ‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡πÉ‡∏ä‡πâ Interface (IProductService, IProductRepository) ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ô |
| **Test ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢**       | ‡πÅ‡∏ï‡πà‡∏•‡∏∞ Layer test ‡πÅ‡∏¢‡∏Å‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢ Mock                                           |
| **‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô DB ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢** | ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å MSSQL ‚Üí PostgreSQL ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏Ñ‡πà Repository                     |
 
#
### üîπ 1.4 record  ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?
`record` ‡∏Ñ‡∏∑‡∏≠ **‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (data type)** ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô C# ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà **C# 9.0** ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤ (data-centric)** ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ **‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏° (behavior)**

#### üßæ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á `record`

> `record` ‡∏Ñ‡∏∑‡∏≠‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö Immutable ‡πÇ‡∏î‡∏¢ Default ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ **Value-Based Equality** ‡πÅ‡∏ó‡∏ô **Reference-Based Equality** ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô class ‡∏õ‡∏Å‡∏ï‡∏¥

#### üîç ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á `record`

| ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô                                | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î                                                    |
| -------------------------------------- | ------------------------------------------------------------- |
| ‚úÖ **Value Equality**                   | ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö object ‡∏à‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏∏‡∏Å property ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà address |
| ‚úÖ **Immutable by default**             | ‡πÉ‡∏ä‡πâ `init` ‡πÅ‡∏ó‡∏ô `set`, ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á           |
| ‚úÖ **Concise Syntax**                   | ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏™‡∏±‡πâ‡∏ô‡∏Å‡∏ß‡πà‡∏≤ class ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ö‡∏ö positional                    |
| ‚úÖ **Built-in Copy**                    | ‡πÉ‡∏ä‡πâ `with` expression ‡πÄ‡∏û‡∏∑‡πà‡∏≠ copy ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ö‡∏≤‡∏á‡∏Ñ‡πà‡∏≤            |
| ‚úÖ **‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö DTO / ViewModel / Event** | ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏µ behavior ‡∏ô‡πâ‡∏≠‡∏¢ ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•          |
 
#### üß† ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏≠‡∏∞‡πÑ‡∏£?

| ‡πÉ‡∏ä‡πâ `record` ‡πÄ‡∏°‡∏∑‡πà‡∏≠...                        | ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•                            |
| -------------------------------------------- | --------------------------------- |
| ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Immutable Object                   | ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à |
| ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á DTO / ViewModel                      | ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ logic ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô     |
| ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Copy ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡πÅ‡∏Ñ‡πà‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô      | ‡πÉ‡∏ä‡πâ `with` expression             |
| ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏≤ (Value Equality) | ‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ô Unit Test                 |

#
#### üìå ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏±‡πâ‡∏ô ‡πÜ

> `record` = **"class ‡∏ó‡∏µ‡πà‡πÄ‡∏ô‡πâ‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"**
> ‚úÖ Immutable, ‚úÖ Value Equality, ‚úÖ Syntax ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö
> ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö DTO, Response, Command, Query ‡πÉ‡∏ô Clean Architecture

#
### üîπ 1.5 Dapper ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?
Dapper ‡πÄ‡∏õ‡πá‡∏ô Micro ORM (Object-Relational Mapper) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö .NET ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏π‡∏á ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô SQL Query ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡∏ñ‡πâ‡∏≤ Query ‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏≤‡∏ß 8 ‡πÄ‡∏°‡∏ï‡∏£ ... ‡∏à‡∏á‡πÉ‡∏ä‡πâ‡∏°‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞...

![image](https://github.com/user-attachments/assets/9b9a7864-5b92-4450-b2a0-292bcea74210)
https://blog.byalex.dev/article/dapper-queries-synchronized-with-mssql-database-schema
 
---

### üîπ 1.6 Serilog ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?

**Serilog** ‡∏Ñ‡∏∑‡∏≠ **logging library** (‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å log) ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢‡πÉ‡∏ô .NET (C#) ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ñ‡∏∑‡∏≠:

* ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö **structured logging** (‡∏Å‡∏≤‡∏£ log ‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á ‡πÄ‡∏ä‡πà‡∏ô JSON)
* ‚úÖ ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö **Microsoft.Extensions.Logging** ‡πÑ‡∏î‡πâ (‡∏ï‡∏±‡∏ß logging built-in ‡∏Ç‡∏≠‡∏á .NET Core)
* ‚úÖ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á log ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ (‡πÄ‡∏ä‡πà‡∏ô Console, File, Seq, Elasticsearch, Application Insights, Datadog, Grafana Loki ‡∏Ø‡∏•‡∏Ø) ‡∏ú‡πà‡∏≤‡∏ô **Sinks**
* ‚úÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏°‡∏≤‡∏Å ‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏•‡∏∞‡∏ú‡πà‡∏≤‡∏ô `appsettings.json`

#

### üîπ Serilog ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà?

Serilog ‡∏ñ‡∏π‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ **Nicholas Blumhardt**
üî∏ ‡πÄ‡∏õ‡∏¥‡∏î‡∏ï‡∏±‡∏ß‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏ö‡∏ô GitHub ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á **‡∏õ‡∏µ 2013**
üî∏ ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÉ‡∏ô‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°‡∏î‡πâ‡∏≤‡∏ô Logging ‡∏ö‡∏ô .NET

#

### üîπ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô?

Serilog ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡πÅ‡∏≠‡∏õ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ **Logging ‡∏ó‡∏µ‡πà‡∏î‡∏µ ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏á‡πà‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏î‡∏µ** ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞:

#### ‚úÖ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö:

| ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÅ‡∏≠‡∏õ                                                 | ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞                                      |
| --------------------------------------------------------- | --------------------------------------------------- |
| üåê **Web API / Web Apps (.NET Core)**                     | ‡∏°‡∏µ Middleware, Request/Response Logging, Trace ‡πÑ‡∏î‡πâ  |
| üõ† **Microservices / Distributed Systems**                | Structured Logging ‡∏ä‡πà‡∏ß‡∏¢‡∏ó‡∏≥ Observability ‡πÑ‡∏î‡πâ‡∏î‡∏µ       |
| üß† **Enterprise Systems**                                 | ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Logging to Seq, Kibana, Grafana              |
| üì¶ **Background Services / Worker Services / Batch Jobs** | ‡∏™‡πà‡∏á log ‡πÑ‡∏õ‡∏¢‡∏±‡∏á file ‡∏´‡∏£‡∏∑‡∏≠ dashboard ‡πÄ‡∏û‡∏∑‡πà‡∏≠ monitor ‡πÑ‡∏î‡πâ |
| üß™ **‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Debug / Trace ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î**          | Logging ‡∏°‡∏µ context, method, ‡πÅ‡∏•‡∏∞ arguments ‡πÑ‡∏î‡πâ       |

#

### üîπ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Log ‡πÅ‡∏ö‡∏ö Structured (Serilog)

```json
{
  "Timestamp": "2025-05-19T08:00:00Z",
  "Level": "Information",
  "MessageTemplate": "User {UserId} placed order {OrderId}",
  "Properties": {
    "UserId": 1234,
    "OrderId": 5678
  }
}
```

> üß† ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö Logging/Monitoring ‡πÄ‡∏ä‡πà‡∏ô **Azure Log Analytics**, **Seq**, **Elasticsearch** ‡∏´‡∏£‡∏∑‡∏≠ **Grafana** ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Log ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£ Log ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤

#

### ‚úÖ **‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°**

| Feature / Tool              | **NLog**                       | **Serilog**                                    | **System.Diagnostics** (`Trace`)        |
| --------------------------- | ------------------------------ | ---------------------------------------------- | --------------------------------------- |
| **‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó**                  | External Logging Framework     | External Logging Framework                     | Built-in Logging (BCL)                  |
| **Structured Logging**      | ‚ùå ‡∏à‡∏≥‡∏Å‡∏±‡∏î (Log ‡πÄ‡∏õ‡πá‡∏ô Text-Based)  | ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö (Structured, JSON ‡∏Ø‡∏•‡∏Ø)      | ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ                                 |
| **Configurable Targets**    | ‚úÖ ‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏¢ (File, DB, Email ‡∏Ø‡∏•‡∏Ø) | ‚úÖ ‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô Sink                              | ‚ö†Ô∏è ‡∏à‡∏≥‡∏Å‡∏±‡∏î (TextWriter, EventLog ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô) |
| **Ease of Setup**           | ‚úÖ ‡∏á‡πà‡∏≤‡∏¢‡∏°‡∏≤‡∏Å                      | ‚úÖ ‡∏á‡πà‡∏≤‡∏¢ ‡∏û‡∏£‡πâ‡∏≠‡∏° Extension ‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏¢                  | ‚úÖ ‡∏á‡πà‡∏≤‡∏¢ (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏õ‡πá‡∏ô built-in)             |
| **Performance**             | ‚úÖ ‡πÄ‡∏£‡πá‡∏ß‡∏û‡∏≠‡πÜ ‡∏Å‡∏±‡∏ö Serilog          | ‚úÖ ‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å                                      | ‚úÖ ‡πÄ‡∏£‡πá‡∏ß‡∏û‡∏≠‡∏™‡∏°‡∏Ñ‡∏ß‡∏£                           |
| **Asynchronous Logging**    | ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö                       | ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö                                       | ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß                            |
| **Structured Querying**     | ‚ùå                              | ‚úÖ Query ‡πÑ‡∏î‡πâ ‡πÄ‡∏ä‡πà‡∏ô‡πÉ‡∏ô Seq, Elasticsearch          | ‚ùå ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö                             |
| **Integration ‡∏Å‡∏±‡∏ö ILogger** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô Adapter                 | ‚úÖ Native ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö `Microsoft.Extensions.Logging` | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô `TraceLoggerProvider` ‡πÑ‡∏î‡πâ        |
| **‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö .NET Core / 8+** | ‚úÖ ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°          | ‚úÖ ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î                                     | ‚ö†Ô∏è Built-in ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏ç‡πà          |

#

### üîß **‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô**

| Use Case                                                    | ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥                                      |
| ----------------------------------------------------------- | -------------------------------------------- |
| ‡∏£‡∏∞‡∏ö‡∏ö WebAPI, Microservice  | ‚úÖ ‡πÉ‡∏ä‡πâ **Serilog**                            |
| ‡∏£‡∏∞‡∏ö‡∏ö WinForm, Windows Service ‡∏´‡∏£‡∏∑‡∏≠ legacy app               | ‚úÖ ‡πÉ‡∏ä‡πâ **NLog** ‡∏´‡∏£‡∏∑‡∏≠ **System.Diagnostics**   |
| ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏•‡πá‡∏Å, ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô, debug ‡∏Ç‡∏ì‡∏∞ dev                        | ‚úÖ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å **System.Diagnostics**            | 

---

### üîö ‡∏™‡∏£‡∏∏‡∏õ

> **Serilog ‡∏Ñ‡∏∑‡∏≠ Logging Library ‡∏™‡∏°‡∏±‡∏¢‡πÉ‡∏´‡∏°‡πà** ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö .NET Core ‡πÅ‡∏•‡∏∞ Microservice...
> ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Structured Logging, ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢, ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢ Output ‡πÅ‡∏•‡∏∞‡∏°‡∏µ Ecosystem ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏°‡∏≤‡∏Å

| ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏£?                      | ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ                 |
| --------------------------------- | ---------------------- |
| Structured JSON Log               | **Serilog**            |
| Logging ‡πÅ‡∏ö‡∏ö‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤, ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå    | **NLog**               |
| ‡πÅ‡∏Ñ‡πà debug ‡∏ï‡∏≠‡∏ô dev                 | **System.Diagnostics** |
| ‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö .NET ILogger ecosystem | **Serilog ‡∏´‡∏£‡∏∑‡∏≠ NLog**  |

‡∏´‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤ **Web API, Microservice, ‡∏´‡∏£‡∏∑‡∏≠ Distributed System** ‡∏î‡πâ‡∏ß‡∏¢ .NET ‚Üí Serilog ‡∏Ñ‡∏∑‡∏≠ ‚Äú‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‚Äù ‡∏ì ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ 
 
#
### 1.4 ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ:
1.  **Visual Studio 2022,VSCode** .NET 6.0 ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏Å‡∏ß‡πà‡∏≤
2.  **SQL Server Management Studio (SSMS)** ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• SQL Server ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
3.  **SQL Server LocalDB** (‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö Visual Studio)
4.  **Postman** ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏≠‡∏∑‡πà‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö API

#

## üõ†Ô∏è ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö Product API ‡∏î‡πâ‡∏ß‡∏¢ .NET 8 + Dapper + Clean Architecture

## üîß Stack ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

* ASP.NET Core Web API
* Dapper (Micro ORM)
* MSSQL LocalDB
* Serilog (Logging)
* Clean Architecture
* SOLID Principles
* Middleware (Exception Handling, Logging, Response Wrapping)

---

## 1Ô∏è‚É£ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Project WebAPI ...

```
ProductAPI/
‚îú‚îÄ‚îÄ Program.cs
‚îú‚îÄ‚îÄ appsettings.json
‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îî‚îÄ‚îÄ ProductsController.cs
‚îú‚îÄ‚îÄ Domain/
‚îÇ   ‚îú‚îÄ‚îÄ Entities/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Product.cs
‚îÇ   ‚îî‚îÄ‚îÄ Interfaces/
‚îÇ       ‚îî‚îÄ‚îÄ IProductRepository.cs
‚îú‚îÄ‚îÄ Application/
‚îÇ   ‚îú‚îÄ‚îÄ DTOs/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProductCreateDTO.cs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProductResponseDTO.cs
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ProductUpdateDTO.cs
‚îÇ   ‚îú‚îÄ‚îÄ Interfaces/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ IProductService.cs
‚îÇ   ‚îî‚îÄ‚îÄ Services/
‚îÇ       ‚îî‚îÄ‚îÄ ProductService.cs
‚îú‚îÄ‚îÄ Infrastructure/
‚îÇ   ‚îî‚îÄ‚îÄ Repositories/
‚îÇ       ‚îî‚îÄ‚îÄ ProductRepository.cs
‚îú‚îÄ‚îÄ Middleware/
‚îÇ   ‚îú‚îÄ‚îÄ ExceptionMiddleware.cs
‚îÇ   ‚îî‚îÄ‚îÄ TODO...Middleware.cs
‚îú‚îÄ‚îÄ Common/
‚îÇ   ‚îú‚îÄ‚îÄ ApiResponse.cs
‚îî‚îÄ‚îÄ Logs/
    ‚îî‚îÄ‚îÄ log-*.txt
```

#

## 2Ô∏è‚É£ ‡∏™‡∏£‡πâ‡∏≤‡∏á Database ‡πÅ‡∏•‡∏∞ Table

### üì¶ Database: MSSQL LocalDB

```sql
CREATE TABLE Products (
    Id INT PRIMARY KEY IDENTITY(1,1),
    Name NVARCHAR(100) NOT NULL,
    Description NVARCHAR(255),
    Price DECIMAL(18,2) NOT NULL,
    Stock INT NOT NULL,
    CreatedAt DATETIME NOT NULL DEFAULT GETDATE(),
    UpdatedAt DATETIME NULL
);
```

---

## 3Ô∏è‚É£ ‡∏™‡∏£‡πâ‡∏≤‡∏á Project ‡πÅ‡∏ö‡∏ö Step-by-Step

### ‚úÖ Step 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á Solution ‡πÅ‡∏•‡∏∞ Project

```bash
dotnet new webapi -n ProductAPI
cd ProductAPI 
```
### ‚úÖ Step 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ï‡∏≤‡∏° Clean Architecture

```bash
mkdir Domain Application Infrastructure Common
```
‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏ô VS2022/Explorer,VSCode:

```
ProductAPI/
‚îú‚îÄ‚îÄ Controllers/
‚îú‚îÄ‚îÄ Domain/              üß† Entities, ValueObjects
‚îú‚îÄ‚îÄ Application/         üß† DTOs, Interfaces, Services
‚îú‚îÄ‚îÄ Infrastructure/      üß† Repositories, DB Access (Dapper)
‚îú‚îÄ‚îÄ Common/              üß† Shared things (ApiResponse, Exceptions, Middlewares)
‚îú‚îÄ‚îÄ Program.cs, appsettings.json, etc.
```
 
#

## 4Ô∏è‚É£ Step-by-Step ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Code (‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏Å SOLID ‡πÅ‡∏•‡∏∞ Clean Code)

![image](https://github.com/user-attachments/assets/9fb2839e-4609-469e-8cee-35d2698972eb)


### ‚úÖ 4.1 ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö SQL Query (‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç:1)
#### GetAll: 
```
SELECT * FROM Products
```
#### GetById:
```
SELECT * FROM Product2 WHERE Id = @Id
```
#### Create:
```
INSERT INTO Products (Name, Description, Price, Stock) 
VALUES (@Name, @Description, @Price, @Stock)
SELECT CAST(SCOPE_IDENTITY() as int)
```
#### Update:
```
UPDATE Products SET 
Name = @Name, 
Description = @Description, 
Price = @Price, 
Stock = @Stock 
WHERE Id = @Id
```

#### Delete:
```
DELETE FROM Products WHERE Id = @Id
```

### ‚úÖ 4.2 ‡∏™‡∏£‡πâ‡∏≤‡∏á Repository (Infrastructure Layer) (‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç:2)

‡πÄ‡∏≠‡∏≤ SQL Query ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÑ‡∏ß‡πâ ‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô Code #
‡πÉ‡∏ô Layer ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

üìÅ 4.1.1 ‡∏™‡∏£‡πâ‡∏≤‡∏á interface... `Domain/Interfaces/IProductRepository.cs`

```csharp
    public interface IProductRepository
    {
        Task<IEnumerable<Product>> GetAllAsync();
        Task<Product?> GetByIdAsync(int id); 
        Task<Product> CreateAsync(Product product);
        Task<bool> UpdateAsync(Product product);
        Task<bool> DeleteAsync(int id);
    }
```

üìÅ 4.1.2 ‡∏™‡∏£‡πâ‡∏≤‡∏á Class Repository... `Infrastructure/Repositories/ProductRepository.cs`
‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà implement (‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ) ‡∏ï‡∏≤‡∏° interface IProductRepository ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Object-Oriented Programming (OOP) ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡πÉ‡∏ô‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î SOLID, Clean Architecture ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏¢‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô
‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

```csharp
namespace ProductAPI.Infrastructure.Repositories
{
    public class ProductRepository : IProductRepository
    {
        private readonly string _connectionString; 

        public ProductRepository(IConfiguration configuration)
        {
            _connectionString = configuration.GetConnectionString("DefaultConnection")
                ?? throw new ArgumentNullException(nameof(configuration), "Connection string 'DefaultConnection' not found.");
        }


        public async Task<IEnumerable<Product>> GetAllAsync()
        { 
            //throw new SqlException("Simulated database error Repository Layer...");

            using IDbConnection db = new SqlConnection(_connectionString);
            return await db.QueryAsync<Product>("SELECT * FROM Products");
        }

        public async Task<Product?> GetByIdAsync(int id)
        {
            using IDbConnection db = new SqlConnection(_connectionString);
            return await db.QueryFirstOrDefaultAsync<Product>(
                "SELECT * FROM Products WHERE Id = @Id", new { Id = id });
        }
         
        public async Task<Product> CreateAsync(Product product)
        {
            using IDbConnection db = new SqlConnection(_connectionString);
            var sql = @"INSERT INTO Products (Name, Description, Price, Stock) 
                    VALUES (@Name, @Description, @Price, @Stock);
                    SELECT CAST(SCOPE_IDENTITY() as int)";
             
            var newId = await db.QuerySingleAsync<int>(sql, product);
            product.Id = newId; 
            return product;
        }

        public async Task<bool> UpdateAsync(Product product)
        {
            using IDbConnection db = new SqlConnection(_connectionString);
            var sql = @"UPDATE Products SET 
                    Name = @Name, 
                    Description = @Description, 
                    Price = @Price, 
                    Stock = @Stock 
                    WHERE Id = @Id";
            var affected = await db.ExecuteAsync(sql, product);
            return affected > 0;
        }

        public async Task<bool> DeleteAsync(int id)
        {
            using IDbConnection db = new SqlConnection(_connectionString);
            var affected = await db.ExecuteAsync(
                "DELETE FROM Products WHERE Id = @Id", new { Id = id });
            return affected > 0;
        }
    }
}
```
**üß† SOLID Principles:**
 
 * **Single Responsibility Principle (SRP):** `ProductRepository` ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Product ‡πÉ‡∏ô Database ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Data Access.
 * **Dependency Inversion Principle (DIP):** Implement `IProductRepository` ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏î‡∏¢ Application Layer.
#




### ‚úÖ 4.3 ‡∏™‡∏£‡πâ‡∏≤‡∏á Service Layer (Application Layer) (‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç:3)

 

üìÅ 4.3.1 ‡∏™‡∏£‡πâ‡∏≤‡∏á Entity (Domain Layer) `Domain/Entities/Product.cs`

```csharp
namespace ProductAPI.Domain.Entities
{
    public class Product
    {
        public int Id { get; set; }
        public string Name { get; set; } = string.Empty;
        public string? Description { get; set; }
        public decimal Price { get; set; }
        public int Stock { get; set; }
        public DateTime CreatedAt { get; set; }
        public DateTime? UpdatedAt { get; set; }
    }
}


```
*‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:* ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ `string.Empty` ‡πÅ‡∏•‡∏∞ `?` (nullable reference types) ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Nullability ‡πÉ‡∏ô C# 8.0+

**üß† SOLID Principles:**

* **S (Single Responsibility)**: Entity ‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
* Clean Code: ‡∏ä‡∏∑‡πà‡∏≠ class/field ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô, ‡πÉ‡∏ä‡πâ type ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

#

‡∏™‡∏£‡πâ‡∏≤‡∏á Service Layer ‡πÅ‡∏•‡πâ‡∏ß Inject Repository Layer ‡∏ú‡πà‡∏≤‡∏ô interface... IProductRepository
‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Model DTOs (Data Transfer Objects) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Layer ‡∏î‡πâ‡∏ß‡∏¢‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ record ‡πÅ‡∏ó‡∏ô class

üìÅ 4.3.2 ‡∏™‡∏£‡πâ‡∏≤‡∏á DTOs

üìÅ `Application/DTOs/ProductCreateDTO.cs`

```csharp
namespace ProductAPI.Application.DTOs
{
    public record ProductCreateDTO(
        [Required(ErrorMessage = "Product name is required."),StringLength(100, MinimumLength = 3, ErrorMessage = "Product name must be between 3 and 100 characters.")]
        string Name,

        string? Description,

        [Range(0.01, 1000000, ErrorMessage = "Price must be greater than 0.")]  
        decimal Price,

        [Range(0, int.MaxValue, ErrorMessage = "Stock must be a non-negative number.")]
        int Stock

   ); 

}

```
üìÅ `Application/DTOs/ProductResponseDTO.cs`

```csharp
namespace ProductAPI.Application.DTOs
{
    public record ProductResponseDTO( 
        int Id,
        string Name,
        string? Description,
        decimal Price,
        int Stock,
        DateTime CreatedAt,
        DateTime? UpdatedAt
        );
}
```
üìÅ `Application/DTOs/ProductUpdateDTO.cs`

```csharp

namespace ProductAPI.Application.DTOs
{
    public record ProductUpdateDTO( 

      
        [Required(ErrorMessage = "Product ID is required for update.")]
        int Id,

        [Required(ErrorMessage = "Product name is required."),StringLength(100, MinimumLength = 3, ErrorMessage = "Product name must be between 3 and 100 characters.")]
        string? Name,

        string? Description,

        [Range(0.01, 1000000, ErrorMessage = "Price must be greater than 0.")]
        decimal? Price,

        [Range(0, int.MaxValue, ErrorMessage = "Stock must be a non-negative number.")]
        int? Stock

        );
}


```
* DTO = ‡∏Ñ‡∏•‡∏≤‡∏™‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏á/‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á

**üß† SOLID Principles:**

* **I (Interface Segregation)**: ‡πÅ‡∏¢‡∏Å DTO ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ Entity ‡∏ï‡∏£‡∏á ‡πÜ
* ‡πÉ‡∏ä‡πâ `record` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö, immutable

#

üìÅ 4.3.4 ‡∏™‡∏£‡πâ‡∏≤‡∏á Interface + Service
‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏µ‡∏¢‡∏Å ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Repository Layer ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£ Inject IProductRepository 

üìÅ `Application/Interfaces/IProductService.cs`

```csharp

namespace ProductAPI.Application.Interfaces
{
    public interface IProductService
    {
        Task<IEnumerable<ProductResponseDTO>> GetAllAsync();
        Task<ProductResponseDTO?> GetByIdAsync(int id);
        Task<ProductResponseDTO> CreateAsync(ProductCreateDTO productDto);
        Task<bool> UpdateAsync(ProductUpdateDTO productDto);
        Task<bool> DeleteAsync(int id);
    }
}


```

üìÅ `Application/Services/ProductService.cs`

```csharp

 // File: Application/Services/ProductService.cs


namespace ProductAPI.Application.Services
{
    public class ProductService : IProductService
    {
        private readonly IProductRepository _productRepository;

        public ProductService(IProductRepository productRepository)
        {
            _productRepository = productRepository;
        }

        public async Task<IEnumerable<ProductResponseDTO>> GetAllAsync()
        {
            var products = await _productRepository.GetAllAsync();

            //throw new InvalidOperationException("Simulated exception in Service Layer");
            return products.Select(p => MapToDTO(p));
        }

        public async Task<ProductResponseDTO?> GetByIdAsync(int id)
        {
            var product = await _productRepository.GetByIdAsync(id);
            return product != null ? MapToDTO(product) : null;
        }

        public async Task<ProductResponseDTO> CreateAsync(ProductCreateDTO productDto)
        { 
            var entity = new Product
            {
                Name = productDto.Name,
                Description = productDto.Description,
                Price = productDto.Price,
                Stock = productDto.Stock,
                CreatedAt = DateTime.UtcNow
            };
             
            var newProduct = await _productRepository.CreateAsync(entity);
            return MapToDTO(newProduct);

        }

        public async Task<bool> UpdateAsync(ProductUpdateDTO updateProductDto)
        { 
            var existingProduct = await _productRepository.GetByIdAsync(updateProductDto.Id);
            if (existingProduct is null)
                return false;

            existingProduct.Name = updateProductDto.Name ?? existingProduct.Name;
            existingProduct.Description = updateProductDto.Description ?? existingProduct.Description;
            existingProduct.Price = updateProductDto.Price ?? existingProduct.Price;
            existingProduct.Stock = updateProductDto.Stock ?? existingProduct.Stock;
            existingProduct.UpdatedAt = DateTime.UtcNow;

            return await _productRepository.UpdateAsync(existingProduct);

        }

        public async Task<bool> DeleteAsync(int id)
        {
            return await _productRepository.DeleteAsync(id);
        }

        private static ProductResponseDTO MapToDTO(Product product)
        {
            return new ProductResponseDTO(
                product.Id,
                product.Name,
                product.Description,
                product.Price,
                product.Stock,
                product.CreatedAt,
                product.UpdatedAt
              );
        }
    }
}

```
**üß† SOLID Principles:**

* **S Single Responsibility Principle (SRP):** `ProductService` ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Business Logic ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Product ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö Repository.
* **D (Dependency Inversion)**: ‡πÉ‡∏ä‡πâ Interface ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡∏Å‡∏ï‡∏£‡∏á
* **O (Open/Closed Principle (OCP))**: ‡πÅ‡∏Å‡πâ Service ‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö Layer ‡∏≠‡∏∑‡πà‡∏ô
* Clean Code: Function name ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô, ‡πÉ‡∏ä‡πâ LINQ ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
#



### ‚úÖ 4.4 Controller (API Layer) (‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç:4)

‡πÉ‡∏ô Layer ‡∏ô‡∏µ‡πâ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ProductService Layer ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£ Inject IProductService 

üìÅ `Controllers/ProductsController.cs`

```csharp


namespace ProductAPI.Controllers
{
    [Route("api/[controller]")]
    [ApiController]
    public class ProductsController : ControllerBase
    {
        private readonly IProductService _productService;
        private readonly ILogger<ProductsController> _logger;

        public ProductsController(ILogger<ProductsController> logger ,IProductService productService)
        {
            _productService = productService;
            _logger = logger;
        }

        [HttpGet] 
        public async Task<ActionResult<IEnumerable<ProductResponseDTO>>> GetAllProducts()
        { 
            try
            {
                var products = await _productService.GetAllAsync();

                var response = ApiResponse<IEnumerable<ProductResponseDTO>>.SuccessResponse(
                    data: products,
                    message: "Products retrieved successfully",
                    statusCode: StatusCodes.Status200OK
                );

                //throw new Exception(" Simulated Exception in Controller *********** ");
                return Ok(response);
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Error occurred in GetAllProducts");
                var errorResponse = ApiResponse<object>.FailResponse(
                    message: "An unexpected error occurred while fetching products.",
                    statusCode: StatusCodes.Status500InternalServerError,
                    error: ex.Message // ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö StackTrace ‡∏Å‡πá‡πÑ‡∏î‡πâ
                );

                return StatusCode(StatusCodes.Status500InternalServerError, errorResponse);
            }

        }

        [HttpGet("api/Products2")]
        public async Task<ActionResult<ApiResponse<IEnumerable<ProductResponseDTO>>>> Get()
        {
            var products = await _productService.GetAllAsync();
            return Ok(ApiResponse<IEnumerable<ProductResponseDTO>>.SuccessResponse(products));
        }

        [HttpGet("{id}")]
        public async Task<ActionResult<ApiResponse<ProductResponseDTO>>> Get(int id)
        {
            var product = await _productService.GetByIdAsync(id);
            return product != null
                ? Ok(ApiResponse<ProductResponseDTO>.SuccessResponse(product))
                : NotFound(ApiResponse<ProductResponseDTO>.FailResponse("Product not found", 404));
        }

        [HttpPost]
        public async Task<ActionResult<ApiResponse<ProductResponseDTO>>> Post([FromBody] ProductCreateDTO dto)
        { 

            var product = await _productService.CreateAsync(dto);

            //throw new Exception("Test Exception CreatedAtAction -----------------------");
            return CreatedAtAction(nameof(Get), new { id = product.Id },  ApiResponse<ProductResponseDTO>.SuccessResponse(product, "Product created", 201));
        }

        [HttpPut("{id}")]
        public async Task<ActionResult<ApiResponse<object>>> Put(int id, [FromBody] ProductUpdateDTO dto)
        {
            if (id != dto.Id)
                return BadRequest(ApiResponse<object>.FailResponse("Invalid product ID", 400));

            var result = await _productService.UpdateAsync(dto);
            return result
                ? Ok(ApiResponse<object>.SuccessResponse(null, "Product updated"))
                : NotFound(ApiResponse<object>.FailResponse("Product not found", 404));
        }

        [HttpDelete("{id}")]
        public async Task<ActionResult<ApiResponse<object>>> Delete(int id)
        {
            var result = await _productService.DeleteAsync(id);
            return result
                ? Ok(ApiResponse<object>.SuccessResponse(null, "Product deleted"))
                : NotFound(ApiResponse<object>.FailResponse("Product not found", 404));
        }
    }
}

```

*‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ Clean Code:*
    * **Clear Naming:** ‡∏ä‡∏∑‡πà‡∏≠ Method ‡πÅ‡∏•‡∏∞ Variable ‡∏™‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢.
    * **Small Methods:** ‡πÅ‡∏ï‡πà‡∏•‡∏∞ Action Method ‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß.
    * **Comments:** ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö.
    * **Logging:** ‡πÄ‡∏û‡∏¥‡πà‡∏° Log ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ Debug.
    *‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ SOLID:*
    * **Single Responsibility Principle (SRP):** Controller ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ HTTP Request/Response ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ Service Layer. ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ Business Logic ‡πÉ‡∏ô Controller.
    
**üß† SOLID Principles:**

* **D (Dependency Inversion)**: Controller ‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö Implementation
* Clean Code: Response ‡πÄ‡∏õ‡πá‡∏ô `ApiResponse`, ‡πÅ‡∏¢‡∏Å logic ‡πÑ‡∏õ Service

#

### ‚úÖ 4.5 Register Service ‡πÅ‡∏•‡∏∞‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° Class ‡∏≠‡∏∑‡πà‡∏ô ‡πÄ‡∏ä‡πà‡∏ô Middleware + Api Response Wrapper (Common) (‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç:5)

üìÅ 4.5.1 Response Wrapper ... `Common/ApiResponse.cs`

```csharp
namespace ProductAPI.Common
{
    public record ApiResponse<T>(int StatusCode, bool Success, string Message, T? Data, string? Error = null)
    {
        public static ApiResponse<T> SuccessResponse(T data, string message = "Success", int statusCode = 200) => new(statusCode, true, message, data);

        public static ApiResponse<T> FailResponse(string message = "Failed", int statusCode = 400, string? error = null) => new(statusCode, false, message, default, error);
    }

}
```

## ‚ú® ResponseBody (Wrapped)

```json
{
  "success": true,
  "message": null,
  "data": [
    {
      "id": 1,
      "name": "Laptop X1",
      "price": 1200,
      "stock": 10,
      "createdAt": "2025-05-15T15:30:00",
      "updatedAt": null
    }
  ]
}
```

üìÅ 4.5.2 `Middleware/ExceptionMiddleware.cs`

```csharp

namespace ProductAPI.Middleware
{
    public class ExceptionMiddleware
    {
        private readonly RequestDelegate _next;
        private readonly ILogger<ExceptionMiddleware> _logger;

        public ExceptionMiddleware(RequestDelegate next, ILogger<ExceptionMiddleware> logger)
        {
            _next = next;
            _logger = logger;
        }

        public async Task InvokeAsync(HttpContext context)
        {
            try
            {
                context.Request.EnableBuffering();
                await _next(context);
            }
            catch (Exception ex)
            {
                // Get Action Name from endpoint
                var endpoint = context.GetEndpoint();
                var actionName = endpoint?.DisplayName ?? "UnknownAction";

                // Read Request Body
                var requestBody = await ReadRequestBodyAsync(context.Request);

                // StackTrace
                var st = new StackTrace(ex, true);
                var frame = st.GetFrames()?.FirstOrDefault(f => f.GetFileLineNumber() > 0);
                var methodInfo = frame?.GetMethod();
                var declaringType = methodInfo?.DeclaringType;

                // Extract original method name (handle async state machine)
                var originalMethodName = declaringType?.Name;
                string methodName;
                if (!string.IsNullOrWhiteSpace(originalMethodName) && originalMethodName.Contains("<") && originalMethodName.Contains(">"))
                {
                    var start = originalMethodName.IndexOf("<") + 1;
                    var end = originalMethodName.IndexOf(">");
                    methodName = originalMethodName.Substring(start, end - start);
                }
                else
                {
                    methodName = methodInfo?.Name ?? "UnknownMethod";
                }

                // Get class name (real class, not compiler generated)
                var className = declaringType?.DeclaringType?.Name ?? declaringType?.Name ?? "UnknownClass";
                var lineNumber = frame?.GetFileLineNumber();

                // Compose Error Detail
                var errorDetail = $"Class: {className}, Method: {methodName}, Line: {lineNumber}, Action: {actionName}, Request: {requestBody}";

                // Log
                _logger.LogError(ex, "Exception occurred: {ErrorDetail}", errorDetail);

                // Return API JSON Response

                context.Items["ExceptionHandled"] = true;

                context.Response.ContentType = "application/json";
                context.Response.StatusCode = StatusCodes.Status500InternalServerError;

                var response = ApiResponse<object>.FailResponse("Internal Server Error", 500, errorDetail);               

                var json = JsonSerializer.Serialize(response);
                await context.Response.WriteAsync(json);
            }
        }

        private async Task<string> ReadRequestBodyAsync(HttpRequest request)
        {
            try
            {
                request.Body.Position = 0;
                using var reader = new StreamReader(request.Body, Encoding.UTF8, leaveOpen: true);
                var body = await reader.ReadToEndAsync();
                request.Body.Position = 0;
                return body;
            }
            catch
            {
                return "Unable to read request body.";
            }
        }

    }
} 

```

üìÅ 4.5.3 Register Service ‡πÉ‡∏ô `Program.cs`

```csharp
using ProductAPI.Application.Interfaces;
using ProductAPI.Application.Services;
using ProductAPI.Domain.Interfaces;
using ProductAPI.Infrastructure.Repositories;
using ProductAPI.Middleware; 
using Serilog;

var builder = WebApplication.CreateBuilder(args);

// Add services to the container.
builder.Services.AddControllers();

// Configure Serilog
Log.Logger = new LoggerConfiguration()
    .ReadFrom.Configuration(builder.Configuration)
    .CreateLogger();

builder.Host.UseSerilog();

// Register services
builder.Services.AddScoped<IProductService, ProductService>();
builder.Services.AddScoped<IProductRepository, ProductRepository>();

builder.Services.AddEndpointsApiExplorer();
builder.Services.AddSwaggerGen();

var app = builder.Build();

// Configure the HTTP request pipeline.
if (app.Environment.IsDevelopment())
{
    app.UseSwagger();
    app.UseSwaggerUI();
}

app.UseHttpsRedirection();
app.UseAuthorization();

// Custom Middleware
app.UseMiddleware<ExceptionMiddleware>();


app.MapControllers();

app.Run();

```

üìÅ 4.5.4 `appsettings.json`

```csharp
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=(localdb)\\mssqllocaldb;Database=ProductDB;Trusted_Connection=True;MultipleActiveResultSets=true"
  },
  "Serilog": {
    "Using": [ "Serilog.Sinks.Console", "Serilog.Sinks.File" ],
    "MinimumLevel": "Information",
    "WriteTo": [
      { "Name": "Console" },
      {
        "Name": "File",
        "Args": {
          "path": "Logs/log-.txt",
          "rollingInterval": "Day"
        }
      }
    ]
  }
}
```
#

## üîö ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞ SOLID

| ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö                                                  |
| ------- | --------------------------------------------------------------- |
| **S**   | `Product`, `ProductService`, `ProductRepository` ‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞ |
| **O**   | ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏ú‡πà‡∏≤‡∏ô Interface, Middleware                         |
| **L**   | ‡∏ó‡∏∏‡∏Å Class ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏ú‡πà‡∏≤‡∏ô Interface                      |
| **I**   | ‡πÑ‡∏°‡πà‡∏¢‡∏±‡∏î method ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏ô Interface                          |
| **D**   | Controller ‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Implementation (‡πÉ‡∏ä‡πâ DI)                |

#
## ‚úÖ ‡∏™‡∏£‡∏∏‡∏õ Feature ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ô Starter Template ‡∏ô‡∏µ‡πâ:

| Feature                        | ‚úÖ ‡∏Ñ‡∏£‡∏ö |
| ------------------------------ | ----- |
| Clean Architecture             | ‚úÖ     |
| Dapper ORM                     | ‚úÖ     |
| Repository Pattern             | ‚úÖ     |
| DTO Mapping                    | ‚úÖ     |
| Middleware: Exception Handling | ‚úÖ     |
| Response Wrapping  | ‚úÖ     |
| Serilog Logging                | ‚úÖ     |
| Dependency Injection           | ‚úÖ     |
| Configurable Connection String | ‚úÖ     |
| Swagger UI (Dev Mode)          | ‚úÖ     |

#
# ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏≤‡∏£‡∏ñ‡∏ô‡∏≤‡∏î‡∏µ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡∏° Core System

